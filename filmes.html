<!DOCTYPE html>

<html>

<head>
	<meta charset="utf-8">

	<title>catalogo de filmes</title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">

	<script src="xmltojson.js"></script>

	<script>
		function getfilmes() {
			let xmlHttp = new XMLHttpRequest();
			xmlHttp.open('GET', 'http://localhost/ajax/filmes.xml');

			xmlHttp.onreadystatechange = function() {
				if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
					let xmlFilmes = xmlHttp.responseText
					

					let parser = new DOMParser()

					domFilmes = parser.parseFromString(xmlFilmes, 'text/xml')
					//console.log(domFilmes)

					jsonFilmes = xmlToJson(domFilmes)

					//console.log(jsonFilmes)


					for(let i in jsonFilmes['filmes']['filme']){
						let item = jsonFilmes['filmes']['filme'][i]

						let divRow = document.createElement('div')
						divRow.className = 'row'

						let divcol = document.createElement('div')
						divcol.className = 'col'

						let p1 = document.createElement('p')
						p1.innerHTML = item['titulo']['#text']

						let p2 = document.createElement('p')
						p2.innerHTML = item['resumo']['#text']

						let genero = ''
						for(let g in item.genero){
							if(genero){
								genero += ', '
							}
							genero += item.genero[g]['#text']
						}

						let p3 = document.createElement('p')
						p3.innerHTML = genero

						let elenco = ''
						for(let e in item.elenco.ator){
							if(elenco){
								elenco += ', '
							}
							elenco += item.elenco.ator[e] ['#text']
						}

						let p4 = document.createElement('p')
						p4.innerHTML = elenco

						let p5 = document.createElement('p')
						p5.innerHTML = item.dataLancamento['#text'] + ' ( ' + item.dataLancamento['@attributes']['pais'] + ' )'

						let hr = document.createElement('hr')

						divRow.appendChild(divcol)
						divcol.appendChild(p1)
						divcol.appendChild(p2)
						divcol.appendChild(p3)
						divcol.appendChild(p4)
						divcol.appendChild(p5)
						divcol.appendChild(hr)

						document.getElementById('lista').appendChild(divRow)


						
					}

					/*

					<div class="row">
						<div class="col">

							<p>titulo</p>
							<p>resumo</p>
							<p>genero</p>
							<p>elenco</p>
							<p>data</p>

							<hr>

						</div>
					</div>

					*/


				}

				if (xmlHttp.readyState == 4 && xmlHttp.status == 404) {

				}
			}

			xmlHttp.send()

		}
	</script>

	

</head>

<body>

	<nav class="navbar navbar-light bg-light mb-4">
		<div class="container">
			<div class="navbar-brand mb-0 h1">
				<h3>catalogo de filmes</h3>
			</div>
		</div>
	</nav>


	<div class="container" id="lista">

		<div class="row mb-5">
			<div class="col">
				<button type="button" class="btn btn-success" onclick="getfilmes()"> listar filmes</button>
			</div>
		</div>

		
		

	</div>


</body>



</html>